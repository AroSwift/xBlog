- content_for :current_page do
  Home
%br

- if first_user?
  %h3
    %center
      = link_to "Setup Up Account as Admin", signup_path, :class => 'firstup'

- if first_post? && logged_in?
  %h3
    %center
      = link_to "Create First Post", post_path, :class => 'firstup' 

- Post.all.order("updated_at DESC LIMIT 20").each do |post|
  %article.posts
    %p.title
      = post.title
      by
      = post.author

      - if logged_in? || admin? then
        - if post.author == session[:current_username] then
          = link_to 'Delete', post_path(:title => post.title, :author => post.author, :content => post.content), :method => :delete, :data => {:confirm => "Are you sure you want to delete '#{post.title}?'"}, class: "dpost"
          = link_to 'Edit', edit_post_path(:title => post.title, :author => post.author, :id => post.id, :content => post.content), class: "pedit"
          
  .small= 'posted ' + compare_time(post.created_at)
  %p.content= post.content

  - Comment.all.order("created_at DESC LIMIT 15").each do |com|
    - if post.id == com.post_id
      %p.comsec
        %b
          = com.user + ':'
        = com.comment
        %b
          - if com.user == session[:current_username]
            = link_to 'Delete', comment_path(:user => com.user, :comment => com.comment, :post_id => com.post_id, :content => post.content), :method => :delete, :data => {:confirm => "Are you sure you want to delete this comment?"}, class: "dcomment"

  - if logged_in? then
    = form_for :com, url: comment_path(:post_id => post.id) do |f|
      %p
        = f.label :comment, "Comment", class: 'comment'
        %br/
        = f.text_field :comment, :maxlength => 250
        = f.submit "Comment", class: 'comment button'